{% extends "base.html" %}

{% load static %}
{% load crispy_forms_tags %}
{% load tag_library %}

{% block page_css %}
<link rel="stylesheet" type="text/css" href={% static "admin-theme/app-assets/css-rtl/pages/dashboard-analytics.css" %}>
<link rel="stylesheet" type="text/css" href={% static "admin-theme/app-assets/css-rtl/pages/card-analytics.css" %}>

<link rel="stylesheet" type="text/css" href={% static "jalali-date-picker/persian-datepicker.css" %}>
<link rel="stylesheet" type="text/css" href={% static "timepicker/jquery.timepicker.min.css" %}>
{% endblock page_css %}

{% block main %}
<div class="row">

	{% include "elements/messages-section.html" %}

	<div class="col-12">
		<div class="row">
			<div class="col-lg-4">
				<div class="row">
					<div class="col-12">
						<div class="card">
							<div class="card-header">
								<h3>درباره {{object.get_full_name}}</h3>
							</div>
							<div class="card-body pt-50 font-medium-1">
								<p>{{object.bio}}</p>
								<hr>
								<div class="mt-1">
									<h6 class="mb-0 font-weight-bold">مهارت ها:</h6>
									{% for item in object.abilities.all %}
									<span class="badge badge-primary mt-25">{{item.name}}</span>
									{% endfor %}
								</div>
								<hr>
								<div class="mt-1">
									<h6 class="mb-0 font-weight-bold">آخرین موقعیت شغلی:</h6>
									<p class="mt-25">Null</p>
								</div>
								<hr>
								<div class="mt-1">
									<h6 class="mb-0 font-weight-bold">تاریخ همراهی با ما:</h6>
									<p class="mt-25">{{object.date_joined|to_jalali}}</p>
								</div>
								<div class="mt-2 text-center">
									<button type="button" class="btn btn-sm btn-icon btn-primary mr-25 p-25 waves-effect waves-light"><i class="feather icon-facebook"></i></button>
									<button type="button" class="btn btn-sm btn-icon btn-primary mr-25 p-25 waves-effect waves-light"><i class="feather icon-twitter"></i></button>
									<button type="button" class="btn btn-sm btn-icon btn-primary p-25 waves-effect waves-light"><i class="feather icon-instagram"></i></button>
								</div>
							</div>
						</div>
					</div>
		
					<div class="col-12">
						<div class="card">
							<div class="card-header">
								<h4 class="card-title">سوابق کاری</h4>
							</div>
							<div class="card-content">
								<div class="card-body">
									<ul class="activity-timeline timeline-left list-unstyled">
										<li>
											<div class="timeline-icon bg-secondary">
												<i class="feather icon-plus font-medium-2 align-middle"></i>
											</div>
											<div class="timeline-info">
												<p class="font-weight-bold mb-0">شرکت اول: <span class="text-black-50">(از 1400-05 تا ...)</span></p>
												<span class="font-small-3">توسعه و برنامه نویسی و مشاوره مالی</span>
											</div>
										</li>
										<li>
											<div class="timeline-icon bg-secondary">
												<i class="feather icon-plus font-medium-2 align-middle"></i>
											</div>
											<div class="timeline-info">
												<p class="font-weight-bold mb-0">شرکت دوم: <span class="text-black-50">(از 1399-01 تا 1400-05)</span></p>
												<span class="font-small-3">توسعه و برنامه نویسی و مشاوره مالی</span>
											</div>
										</li>
										<li>
											<div class="timeline-icon bg-secondary">
												<i class="feather icon-plus font-medium-2 align-middle"></i>
											</div>
											<div class="timeline-info">
												<p class="font-weight-bold mb-0">شرکت دوم: <span class="text-black-50">(از 1391-08 تا 1399-01)</span></p>
												<span class="font-small-3">توسعه و برنامه نویسی و مشاوره مالی</span>
											</div>
										</li>
									</ul>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		
			<div class="col-lg-8">
				<div class="row">

					<div class="col-12">
						<div class="row">
							<div class="col-md-4">
								<div class="card text-center">
									<div class="card-content">
										<div class="card-body">
											<div class="avatar bg-rgba-primary p-50 m-0 mb-1">
												<div class="avatar-content">
													<i class="feather icon-heart text-primary font-medium-5"></i>
												</div>
											</div>
											<h2 class="text-bold-700">68</h2>
											<p class="mb-0 line-ellipsis">امتیاز</p>
										</div>
									</div>
								</div>
							</div>
				
							<div class="col-md-4">
								<div class="card text-center">
									<div class="card-content">
										<div class="card-body">
											<div class="avatar bg-rgba-warning p-50 m-0 mb-1">
												<div class="avatar-content">
													<i class="feather icon-award text-warning font-medium-5"></i>
												</div>
											</div>
											<h2 class="text-bold-700">346</h2>
											<p class="mb-0 line-ellipsis">دستاورد</p>
										</div>
									</div>
								</div>
							</div>
				
							<div class="col-md-4">
								<div class="card text-center">
									<div class="card-content">
										<div class="card-body">
											<div class="avatar bg-rgba-success p-50 m-0 mb-1">
												<div class="avatar-content">
													<i class="feather icon-user-check text-success font-medium-5"></i>
												</div>
											</div>
											<h2 class="text-bold-700">%65</h2>
											<p class="mb-0 line-ellipsis">دسترسی پذیری</p>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
		
					<div class="col-12">
						<div class="row">
							<div class="col-lg-6">
								<div class="card h-100">
									<div class="card-header d-flex justify-content-between align-items-start">
										<div>
											<h4 class="card-title">آمار شخصیتی</h4>
										</div>
									</div>
									<div class="card-content my-auto">
										<div class="card-body px-0">
											<div id="personality-chart"></div>
										</div>
									</div>
								</div>
							</div>
		
							<div class="col-lg-6 mt-3 mt-lg-0">
								<div class="card h-100">
									<div class="card-header d-flex justify-content-between align-items-end">
										<h4 class="mb-0">درصد رضایت مندی</h4>
									</div>
									<div class="card-content">
										<div class="card-body px-0 pb-0">
											<div id="ansewr_rate" class="mt-75"></div>
											<div class="row text-center mx-0 mt-2">
												<div class="col-md-6 border-top border-right d-flex align-items-between flex-column py-1">
													<p class="mb-50">میانگین زمان تعامل</p>
													<p class="font-large-1 text-bold-700 mb-50 mt-25">5 ساعت</p>
												</div>
												<div class="col-md-6 border-top d-flex align-items-between flex-column py-1">
													<p class="mb-50">تعداد منتورینگ ها</p>
													<p class="font-large-1 text-bold-700 mb-50 mt-25">23 جلسه</p>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="col-12 mt-3">
		<div class="row">
			<div class="col-lg-12">
				<div class="card">
					<div class="card-header">
						<h4 class="card-title">درصد رضایت </h4>
					</div>
					<div class="card-content">
						<div class="card body">
							<div id="satisfaction-chart"></div>
						</div>
					</div>
				</div>
			</div>
		
			<div class="col-lg-12">
				<div class="card">
					<div class="card-header">
						<h4 class="card-title">فرم ثبت درخواست جلسه</h4>
					</div>
					<div class="card-content">
						<div class="card-body">
							<form action={% url "account:new-meeting-session" %} method="POST">
								{% csrf_token %}
								<input name="mentor" value="{{object.id}}" hidden>
								<div class="row">
									<div class="col-md-4">
										{{ meeting_form.date|as_crispy_field }}
									</div>
									<div class="col-md-4">
										{{ meeting_form.time|as_crispy_field }}
									</div>
									<div class="col-md-4">
										{{ meeting_form.topic|as_crispy_field }}
									</div>
									<div class="col-md-12">
										{{ meeting_form.description|as_crispy_field }}
									</div>
								</div>
		
								<button class="btn btn-success btn-block" type="submit">ثبت درخواست</button>
							</form>
		
							{% if request.user.team_member_of_meeting.all %}
							<h4 class="mt-3">جلسات درخواست شده شما از این مربی</h4>
								<table class="table table-responsive-md mb-0">
									<thead>
										<tr>
											<th scope="col">#</th>
											<th scope="col">موضوع جلسه</th>
											<th scope="col">توضیحات</th>
											<th scope="col">تاریخ</th>
											<th scope="col">ساعت</th>
											<th scope="col">وضعیت</th>
											<th scope="col">عملیات</th>
										</tr>
									</thead>
									<tbody>
										{% for meeting in request.user.team_member_of_meeting.all %}
											{% if meeting.mentor == object %}
											<tr>
												<th scope="row">{{forloop.counter}}</th>
												<td class="font-weight-bold">{{meeting.topic}}</td>
												<td>{{meeting.description}}</td>
												<td>{{meeting.date|to_jalali}}</td>
												<td>{{meeting.time}}</td>
												<td><span class="badge badge-success">{{meeting.get_status_display}}</span></td>
												<td>
													<span class="badge badge-danger">کنسل کردن</span>
												</td>
											</tr>
											{% endif %}
										{% endfor %}
									</tbody>
								</table>
							{% endif %}
		
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

</div>
{% endblock main %}

{% block page_js %}
<script src={% static "admin-theme/app-assets/vendors/js/charts/apexcharts.min.js" %}></script>
<script src={% static "admin-theme/app-assets/js/scripts/pages/dashboard-analytics.js" %}></script>
<script src={% static "admin-theme/app-assets/js/scripts/cards/card-analytics.js" %}></script>

<script src={% static "jalali-date-picker/jquery-2.2.4.min.js" %}></script>
<script src={% static "jalali-date-picker/persian-date.js" %}></script>
<script src={% static "jalali-date-picker/persian-datepicker.js" %}></script>
<script src={% static "timepicker/jquery.timepicker.min.js" %}></script>

<script>
	// Sales Chart starts
	
	function generateRandomList(length) {
		const randomList = [];
		for (let i = 0; i < length; i++) {
			const randomValue = Math.floor(Math.random() * 10); // Generates a random integer from 0 to 9
			randomList.push(randomValue);
		}
		return randomList;
	}

	var $primary = '#7367F0';
	var $success = '#00db89';
	var $info = '#0DCCE1';
	var $info_light = '#1edec5';
	var $strok_color = '#b9c3cd';
	var $danger = '#EA5455';
	var $warning = '#FF9F43';
	var $primary_light = '#8F80F9';
	var $warning_light = '#FFC085';
	var $danger_light = '#f29292';
	var $label_color = '#e7eef7';
	var $white = '#fff';

	var salesChartoptions = {
	chart: {
		height: 400,
		type: 'radar',
		dropShadow: {
		enabled: true,
		blur: 8,
		left: 1,
		top: 1,
		opacity: 0.2
		},
		toolbar: {
		show: false
		},
	},
	toolbar: { show: false },
	series: [{
		name: 'Sales',
		data: generateRandomList(8),
	}],
	stroke: {
		width: 0
	},
	colors: [$primary, $info],
	plotOptions: {
		radar: {
		polygons: {
			strokeColors: ['#e8e8e8', 'transparent', 'transparent', 'transparent', 'transparent', 'transparent'],
			connectorColors: 'transparent'
		}
		}
	},
	fill: {
		type: 'gradient',
		gradient: {
		shade: 'dark',
		gradientToColors: ['#9f8ed7', $info_light],
		shadeIntensity: 1,
		type: 'horizontal',
		opacityFrom: 1,
		opacityTo: 1,
		stops: [0, 100, 100, 100]
		},
	},
	markers: {
		size: 0,
	},
	legend: {
		show: true,
		position: 'top',
		horizontalAlign: 'left',
		fontSize: '16px',
		markers: {
		width: 10,
		height: 10,
		}
	},
	labels: ['کنترل فشار', 'تصمیم گیری', 'مدیریت مالی', 'مدیریت فروش', 'روابط عمومی', 'کنترل احساسات', 'توسعه بازار', 'توسعه محصول'],
	dataLabels: {
		style: {
		colors: [$strok_color, $strok_color, $strok_color, $strok_color, $strok_color, $strok_color]
		}
	},
	yaxis: {
		show: false,
	},
	grid: {
		show: false,
	},

	}

	var salesChart = new ApexCharts(
	document.querySelector("#personality-chart"),
	salesChartoptions
	);

	salesChart.render();

  // Sales Chart ends //
</script>

<script>
	// Goal Overview  Chart

	var goalChartoptions = {
		chart: {
		height: 250,
		type: 'radialBar',
		sparkline: {
			enabled: true,
		},
		dropShadow: {
			enabled: true,
			blur: 3,
			left: 1,
			top: 1,
			opacity: 0.1
		},
		},
		colors: [$success],
		plotOptions: {
			radialBar: {
				size: 110,
				startAngle: -150,
				endAngle: 150,
				hollow: {
					size: '77%',
				},
				track: {
					background: $strok_color,
					strokeWidth: '50%',
				},
				dataLabels: {
					name: {
						show: false
					},
					value: {
						offsetY: 18,
						color: $strok_color,
						fontSize: '4rem'
					}
				}
			}
		},
		fill: {
			type: 'gradient',
			gradient: {
				shade: 'dark',
				type: 'horizontal',
				shadeIntensity: 0.5,
				gradientToColors: ['#00b5b5'],
				inverseColors: true,
				opacityFrom: 1,
				opacityTo: 1,
				stops: [0, 100]
			},
		},
		series: [66],
		stroke: {
		lineCap: 'round'
		},

	}

	var goalChart = new ApexCharts(
		document.querySelector("#ansewr_rate"),
		goalChartoptions
	);

	goalChart.render();
</script>

<script>
    $("#id_date").persianDatepicker({
        initialValue: false,
        persianDigit: false,
        format: 'YYYY-MM-DD',
    }
    ).attr("autocomplete", "off")

    $("#id_time").addClass("timepicker").attr("autocomplete","off")
    $('.timepicker').timepicker({
        timeFormat: 'H:mm',
        dynamic: false,
        dropdown: true,
        scrollbar: true
    });
</script>

<script>
	var options = {
		series: [{
		name: 'کاملا ناراضی',
		data: [15],
	  }, {
		name: 'ناراضی',
		data: [5],
		
	  }, {
		name: 'بدون استفاده',
		data: [5],
		
	  }, {
		name: 'مفید',
		data: [25],
		
	  }, {
		name: 'کاملا مفید',
		data: [50],
		
	  }],
		chart: {
		type: 'bar',
		height: 150,
		stacked: true,
		stackType: '100%',
		toolbar: false,
	  },
	  colors: ["#c50000", "#c57000", "#c5b100", "#a8c500", "#5fc500"],
	  
	  plotOptions: {
		bar: {
		  horizontal: true,
		},
	  },
	  stroke: {
		width: 1,
		colors: ['#fff']
	  },
	  fill: {
		colors: ["#c50000", "#c57000", "#c5b100", "#a8c500", "#5fc500"]
	  },
	  yaxis: {show: false},
	  xaxis: {show: false},
	  };

	  var chart = new ApexCharts(document.querySelector("#satisfaction-chart"), options);
	  chart.render();
</script>
{% endblock page_js %}